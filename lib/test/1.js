// Generated by CoffeeScript 1.6.3
var Model, Observe, Q, User, Validators, Weather;

Model = require('../model').Model;

Observe = require('../model').Observe;

Validators = require('../model').Validators;

Q = require('q');

Observe.define('repo', {
  name: 'mysql',
  provider: {
    type: 'mysql',
    options: {
      host: 'localhost',
      port: 3306,
      user: 'root',
      password: '123123',
      database: 'test',
      connectionLimit: 4
    }
  }
});

Observe.define('repo', {
  name: 'pg',
  provider: {
    type: 'postgresql',
    options: {
      host: 'localhost',
      port: 5432,
      user: 'jeremy',
      password: '123123',
      database: 'jeremy'
    }
  }
});

Observe.define('cache', {
  name: 'default',
  provider: {
    type: 'redis',
    options: {
      host: 'localhost',
      port: 6379
    }
  }
});

Observe.define('cache', {
  name: 'memcache',
  provider: {
    type: 'memcache',
    options: {
      host: 'localhost',
      port: 11212
    }
  }
});

User = new Model({
  meta: {
    table: 'work',
    repo: 'mysql',
    cache: 'redis',
    fields: [
      {
        name: 'userId',
        type: 'string',
        column: 'id',
        required: true,
        primkey: true
      }, {
        name: 'name',
        type: 'string',
        validator: null
      }, {
        name: 'age',
        type: 'integer',
        validator: new Validators.integer(1, 100)
      }
    ],
    indices: [
      {
        name: 'id',
        fields: ['userId', 'age'],
        unique: true
      }
    ]
  },
  sayHi: function() {
    return console.log('hi');
  }
});

Weather = new Model({
  meta: {
    table: '天气',
    repo: 'pg',
    cache: 'redis',
    fields: [
      {
        name: 'id',
        type: 'integer',
        column: 'id',
        primkey: true
      }, {
        name: 'city',
        type: 'string',
        column: '城市'
      }, {
        name: 'lowTemp',
        type: 'number',
        column: '最低气温'
      }, {
        name: 'highTemp',
        type: 'number',
        column: '最高气温'
      }, {
        name: 'rain',
        type: 'number',
        column: '降水量'
      }, {
        name: 'date',
        type: 'timestamp',
        column: '日期'
      }
    ]
  }
});

User.find({
  userId__gt: 990
}).all().then(function(result) {
  return console.log(result);
}).fail(function(err) {
  return console.log('yep' + err);
});
